# 🔐 관리자 계정 설정 가이드

## CaseNetAI 관리자 계정 생성 방법

---

## 📌 개요

CaseNetAI는 **관리자 전용 계정 생성 페이지**를 제공합니다.  
공개 회원가입이 차단되었으며, 오직 **마스터 비밀번호를 가진 개발자/관리자만** 새 계정을 생성할 수 있습니다.

---

## 🔑 접근 방법

### 1. **관리자 설정 페이지 접속**

```
https://casenetai.kr/admin-setup.html
```

또는 로컬 개발 환경:

```
http://localhost:3000/admin-setup.html
```

---

## 🛡️ 마스터 비밀번호

**마스터 비밀번호**: 환경 변수 `MASTER_PASSWORD`로 설정

⚠️ **보안 주의사항**:
- 이 비밀번호는 절대 코드나 문서에 기록하지 마세요
- `.env` 파일과 Vercel 환경 변수에만 설정하세요
- `.env` 파일은 `.gitignore`에 포함되어 있어 Git에 커밋되지 않습니다
- 최소 16자 이상의 강력한 비밀번호를 사용하세요

**비밀번호 생성 예시**:
```bash
# 32바이트 랜덤 비밀번호 생성
node -e "console.log(require('crypto').randomBytes(24).toString('base64'))"
```

---

## 📝 계정 생성 절차

### Step 1: 마스터 비밀번호 입력

1. 관리자 설정 페이지 접속
2. "마스터 비밀번호" 입력란에 `.env` 파일의 `MASTER_PASSWORD` 값 입력
3. "확인" 버튼 클릭

💡 **참고**: 마스터 비밀번호는 `.env` 파일과 Vercel 환경 변수에 동일하게 설정되어 있어야 합니다.

### Step 2: 계정 정보 입력

- **이메일**: 관리자 이메일 (예: `admin@casenetai.kr`)
- **비밀번호**: 최소 8자 이상 (영문, 숫자, 특수문자 중 2가지 이상)
- **이름**: 관리자 이름
- **전화번호**: (선택 사항)
- **권한**: 
  - `system_admin` (시스템 관리자) - 전체 권한
  - `org_admin` (조직 관리자) - 조직 내 권한
  - `user` (일반 사용자) - 기본 권한
- **초기 크레딧**: 기본값 10,000,000원 (수정 가능)

### Step 3: 계정 생성

1. "계정 생성" 버튼 클릭
2. 생성 완료 메시지 확인
3. 로그인 정보 안전하게 보관

---

## 🎭 권한 레벨

| 권한 | 설명 | 주요 기능 |
|------|------|----------|
| `system_admin` | 시스템 관리자 | 모든 기능 접근, 사용자/조직 관리, 시스템 설정 |
| `org_admin` | 조직 관리자 | 소속 조직 내 사용자 관리, 조직 설정 |
| `user` | 일반 사용자 | 상담일지, 진술서, 익명화 등 기본 기능 |

---

## 💰 크레딧 시스템

- **기본 크레딧**: 10,000,000원 (10만원)
- **사용 예시**:
  - 상담일지 변환: 약 1,000~5,000원/건
  - 진술서 작성: 약 2,000~8,000원/건
  - 문서 익명화: 약 500~2,000원/건

---

## 🔒 보안 기능

### 1. 마스터 비밀번호 검증
- 모든 계정 생성 요청에 마스터 비밀번호 필요
- 프론트엔드와 백엔드 이중 검증

### 2. 공개 회원가입 차단
- `/register.html`은 자동으로 로그인 페이지로 리다이렉트
- API 레벨에서도 마스터 비밀번호 검증 필수

### 3. 비밀번호 정책
- 최소 8자 이상
- 영문, 숫자, 특수문자 중 2가지 이상 포함
- bcrypt 해싱 (SALT_ROUNDS: 12)

---

## 🚀 사용 예시

### 예시 1: 시스템 관리자 생성

```
이메일: admin@casenetai.kr
비밀번호: (환경 변수 ADMIN_PASSWORD 참조)
이름: 시스템 관리자
전화번호: 010-1234-5678
권한: system_admin
크레딧: 10,000,000원
```

### 예시 2: 개발자 계정 생성

```
이메일: dev@casenetai.kr
비밀번호: (환경 변수 DEV_PASSWORD 참조)
이름: 개발자
권한: system_admin
크레딧: 10,000,000원
```

### 예시 3: 테스트 계정 생성

```
이메일: test@casenetai.kr
비밀번호: (환경 변수 TEST_PASSWORD 참조)
이름: 테스트 사용자
권한: user
크레딧: 1,000,000원
```

---

## ⚙️ Vercel 환경 변수 설정

Vercel 대시보드에서 다음 환경 변수를 추가하세요:

```bash
MASTER_PASSWORD=<강력한_비밀번호_16자이상>
```

**강력한 비밀번호 생성**:
```bash
# Node.js를 사용한 랜덤 비밀번호 생성
node -e "console.log(require('crypto').randomBytes(24).toString('base64'))"
```

설정 방법:
1. Vercel 대시보드 → 프로젝트 선택
2. Settings → Environment Variables
3. `MASTER_PASSWORD` 추가
4. 생성한 강력한 비밀번호 입력
5. Production, Preview, Development 모두 체크
6. Save

---

## 🔄 마스터 비밀번호 변경

프로덕션 환경에서는 보안을 위해 마스터 비밀번호를 변경하세요.

### 1. 로컬 환경

`.env` 파일 수정:
```bash
MASTER_PASSWORD=새로운_강력한_비밀번호!@#$
```

### 2. 프로덕션 환경

`.env.production` 파일 수정:
```bash
MASTER_PASSWORD=새로운_강력한_비밀번호!@#$
```

### 3. Vercel 환경 변수

Vercel 대시보드에서 `MASTER_PASSWORD` 값 업데이트

### 4. 프론트엔드 업데이트

`public/admin-setup.html` 파일의 219번 줄 수정:
```javascript
const MASTER_PASSWORD = '새로운_강력한_비밀번호!@#$';
```

---

## 📞 문제 해결

### 문제 1: "마스터 비밀번호가 올바르지 않습니다"

**해결책**:
- 프론트엔드 (`admin-setup.html`)와 백엔드 (`.env`) 비밀번호가 일치하는지 확인
- 대소문자, 특수문자 정확히 입력

### 문제 2: "이미 사용 중인 이메일입니다"

**해결책**:
- 다른 이메일 주소 사용
- 기존 계정을 삭제하고 다시 생성 (DB 관리 필요)

### 문제 3: 계정 생성 후 로그인 실패

**해결책**:
- 생성한 이메일과 비밀번호 정확히 입력
- 대소문자 구분 확인
- 소셜 로그인이 아닌 이메일 로그인 사용

---

## 📋 체크리스트

계정 생성 전 확인사항:

- [ ] 마스터 비밀번호 확인
- [ ] 관리자 설정 페이지 접속 가능
- [ ] 이메일 주소 준비
- [ ] 강력한 비밀번호 생성
- [ ] 권한 레벨 결정
- [ ] 초기 크레딧 금액 결정

계정 생성 후 확인사항:

- [ ] 생성 완료 메시지 확인
- [ ] 로그인 정보 안전하게 보관
- [ ] 로그인 테스트 성공
- [ ] 대시보드 접근 확인
- [ ] 크레딧 잔액 확인

---

## 🔗 관련 링크

- **관리자 설정 페이지**: https://casenetai.kr/admin-setup.html
- **로그인 페이지**: https://casenetai.kr/login.html
- **대시보드**: https://casenetai.kr/dashboard.html

---

## 📅 작성 정보

- **작성일**: 2026-01-21
- **작성자**: AI Developer
- **버전**: 1.0.0

---

**⚠️ 보안 경고**: 이 문서는 개발자/관리자 전용입니다. 마스터 비밀번호를 절대 공개하지 마세요!
