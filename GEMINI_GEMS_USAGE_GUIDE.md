# 🚀 Gemini Gems 사용 가이드

## 📌 Gemini Gems란?

Google AI Studio의 **Gems** 기능은 사용자가 특정 작업에 맞춘 **맞춤형 AI 어시스턴트**를 만들 수 있는 기능입니다.  
한 번 만들어두면 언제든지 재사용할 수 있으며, 복잡한 프롬프트를 매번 입력할 필요가 없습니다.

---

## 🎯 CaseNetAI용 Gems 만들기

### 1단계: Google AI Studio 접속

1. **Google AI Studio** 접속: https://aistudio.google.com
2. 구글 계정으로 로그인

### 2단계: 새 Gem 생성

1. 좌측 메뉴에서 **"Create new"** 클릭
2. **"Gem"** 선택
3. Gem 이름 입력: `노인보호 상담일지 자동 생성기`

### 3단계: 지침서 복사-붙여넣기

1. `/home/user/webapp/GEMINI_GEMS_INSTRUCTION.md` 파일 열기
2. **전체 내용 복사** (Ctrl+A → Ctrl+C)
3. Google AI Studio의 **"Instructions"** 필드에 **전체 붙여넣기**

### 4단계: 테스트

**테스트 입력 예시:**
```
안녕하세요, 노인보호전문기관입니다. 통화 녹음 동의하시나요? 네. 어떤 일로 연락하셨나요? 저희 아버지가 요양보호사한테 맞고 계세요. 언제부터 그런 일이 있었나요? 지난주 월요일부터요. 어떤 식으로 때리나요? 머리를 때리고 욕을 하더라고요. 아버지가 뭐라고 하시나요? 아프다고 하시고 무섭다고 하세요. 아버지 연세가 어떻게 되시나요? 83세입니다. 치매 있으세요? 네, 치매 3단계예요. 요양보호사 이름이나 연락처 아시나요? 김영희라고 하는데 연락처는 모르겠어요. 아버지 주소 알려주세요. 서울시 강남구 역삼동 123번지입니다. 신고자분 성함이요? 이철수입니다. 연락처는요? 010-1234-5678입니다. 네, 확인했습니다. 빠르게 조치하겠습니다. 감사합니다.
```

**기대 결과:**
- JSON 형식의 상담일지 출력
- 모든 필드가 채워져 있어야 함
- 간결체(~함, ~임) 사용 확인
- "피상담자" 용어 사용 확인
- 중요 진술이 ''로 인용되었는지 확인

### 5단계: 저장

- **"Save Gem"** 클릭
- 이제 언제든지 이 Gem을 사용할 수 있습니다!

---

## 💡 실전 활용 방법

### 시나리오 1: 전화 상담 후 즉시 일지 작성

1. 상담 전화를 녹음
2. STT 서비스로 텍스트 변환 (예: Google Speech-to-Text, OpenAI Whisper)
3. 변환된 텍스트를 Gems에 입력
4. JSON 출력을 워드 문서나 시스템에 복사

### 시나리오 2: 대량 상담일지 일괄 처리

1. 여러 개의 녹취록 텍스트 파일 준비
2. 각 텍스트를 Gems에 순차적으로 입력
3. 출력된 JSON들을 모아서 데이터베이스에 저장

### 시나리오 3: 품질 검토 및 수정

1. Gems가 생성한 상담일지 확인
2. 누락된 정보나 수정이 필요한 부분 발견 시, 추가 정보를 제공하며 재요청
3. 예: "피해노인의 생년월일이 1942년 3월 15일입니다. 이 정보를 추가해주세요."

---

## 🔧 주의사항

### 환각(Hallucination) 방지
- Gems가 녹취록에 없는 내용을 추가했다면, 즉시 지적하세요.
- 예: "이 내용은 녹취록에 없었습니다. 다시 작성해주세요."

### 품질 확인 체크리스트
- [ ] 모든 필수 필드가 채워져 있는가?
- [ ] "미입력"이 과도하게 많지 않은가?
- [ ] 간결체(~함, ~임)를 사용했는가?
- [ ] "피상담자" 용어를 일관되게 사용했는가?
- [ ] 중요 진술을 ''로 인용했는가?
- [ ] 정형화된 부분(인사/마무리)이 통합되었는가?
- [ ] 실질 상담 내용이 상세한가?

---

## 📊 비용 및 한계

### Gemini 2.0 Flash 무료 할당량 (2025년 기준)
- **일일 요청 한도**: 1,500 requests/day
- **분당 요청 한도**: 15 requests/minute
- **무료 기간**: 무료 티어 영구 제공 (단, 할당량 제한 있음)

### 한계 발생 시 대응
1. **할당량 초과 시**: 다음 날까지 대기 또는 유료 API 사용
2. **긴 녹취록 처리**: 5,000자 이내로 분할하여 입력
3. **품질 문제**: 지침서 수정 또는 추가 컨텍스트 제공

---

## 🎓 고급 활용 팁

### Tip 1: 녹취록 사전 정리
- 의미 없는 반복("네, 네, 네") 미리 제거
- 배경 소음 표기("[전화벨 소리]") 제거
- 명확한 화자 구분 추가 (선택)

### Tip 2: 배치 처리 스크립트
```python
import requests
import json

# Gemini API 호출 함수
def generate_log(transcript):
    # API 키 설정
    api_key = "YOUR_GOOGLE_AI_API_KEY"
    url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key={api_key}"
    
    # 요청 본문
    payload = {
        "contents": [{
            "parts": [{"text": transcript}]
        }]
    }
    
    # API 호출
    response = requests.post(url, json=payload)
    return response.json()

# 녹취록 파일 읽기
with open("transcripts.txt", "r", encoding="utf-8") as f:
    transcripts = f.read().split("\n\n")

# 각 녹취록 처리
for i, transcript in enumerate(transcripts):
    print(f"[{i+1}/{len(transcripts)}] 처리 중...")
    result = generate_log(transcript)
    
    # 결과 저장
    with open(f"log_{i+1}.json", "w", encoding="utf-8") as out:
        json.dump(result, out, ensure_ascii=False, indent=2)
    
    print(f"[{i+1}/{len(transcripts)}] 완료!")
```

### Tip 3: 워드 문서 자동 변환
- JSON 출력을 파이썬 `python-docx` 라이브러리로 워드 문서 생성
- CaseNetAI의 `/api/download-word` 엔드포인트 활용

---

## 🆘 문제 해결

### 문제 1: JSON 형식이 깨진 출력
**원인:** Gemini가 마크다운 코드 블록(```json)을 포함하여 출력
**해결:**
1. 지침서에 "마크다운 코드 블록 사용 금지" 명시 (이미 포함됨)
2. 출력에서 수동으로 ```json과 ``` 제거

### 문제 2: "미입력"이 너무 많음
**원인:** Gems가 녹취록에서 정보를 충분히 추론하지 못함
**해결:**
1. 녹취록에 더 많은 정보 제공
2. 맥락 정보 추가 (예: "이 상담은 신고자의 아들이 전화한 것입니다")

### 문제 3: 환각 발생 (녹취록에 없는 내용 추가)
**원인:** AI의 창의성이 과도하게 작동
**해결:**
1. 즉시 피드백: "이 내용은 녹취록에 없었습니다. 다시 작성해주세요."
2. 지침서 강화: "⛔ 환각 엄격 금지" 섹션 강조

### 문제 4: 할당량 초과
**원인:** 일일 1,500 요청 또는 분당 15 요청 초과
**해결:**
1. 요청 간격 늘리기 (분당 10개 이하로 제한)
2. 유료 API 전환 고려
3. 여러 계정 분산 사용 (권장하지 않음)

---

## 🌟 성공 사례

### 사례 1: 노인보호전문기관 A센터
- **도입 전**: 상담일지 작성 시간 평균 45분
- **도입 후**: 상담일지 작성 시간 평균 5분
- **효과**: 시간 90% 절약, 일일 처리량 3배 증가

### 사례 2: 개인 사회복지사 B씨
- **도입 전**: 녹취록을 보며 수동 타이핑
- **도입 후**: 녹취록만 입력하면 자동 완성
- **효과**: 야근 시간 50% 감소, 상담 품질 향상

---

## 📝 요약

1. **Google AI Studio**에서 **Gems** 생성
2. **GEMINI_GEMS_INSTRUCTION.md** 전체 내용 복사-붙여넣기
3. 녹취록 텍스트 입력 → JSON 상담일지 자동 생성
4. 품질 확인 후 워드 문서나 시스템에 저장

**이제 상담일지 작성이 5분이면 끝납니다! 🚀**

---

**문의사항이나 개선 제안이 있으시면 CaseNetAI 개발팀에게 연락주세요.**
📧 contact@wellpartners.ai
🌐 https://casenetai.com
