========================================
CaseNetAI ì†ŒìŠ¤ì½”ë“œ (ë§ˆì§€ë§‰ 30í˜ì´ì§€)
ì €ì‘ê¶Œì: ìœ¤í˜„ì¤€
ì‘ì„±ì¼: 2026ë…„ 01ì›” 21ì¼
========================================

========================================
íŒŒì¼: public/js/statement-recording.js
========================================
        const qaElements = document.querySelectorAll('.qa-pair');
        qaElements.forEach((qaEl, index) => {
            const questionEl = qaEl.querySelector('[data-type="question"]');
            const answerEl = qaEl.querySelector('[data-type="answer"]');
            
            if (qaList[index]) {
                qaList[index].question = questionEl.textContent;
                qaList[index].answer = answerEl.textContent;
            }
        });
        
        // í…ìŠ¤íŠ¸ ìƒì„±
        const textContent = generateTextFormat();
        
        // í´ë¦½ë³´ë“œì— ë³µì‚¬
        await navigator.clipboard.writeText(textContent);
        
        showAlert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸°(Ctrl+V)í•˜ì„¸ìš”.', 'success');
    } catch (error) {
        console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì˜¤ë¥˜:', error);
        
        // í´ë¦½ë³´ë“œ APIê°€ ì‘ë™í•˜ì§€ ì•Šì„ ê²½ìš° ëŒ€ì²´ ë°©ë²•
        try {
            const textContent = generateTextFormat();
            const textarea = document.createElement('textarea');
            textarea.value = textContent;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            showAlert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        } catch (fallbackError) {
            showAlert('í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
        }
    }
}

/**
 * ì„ì‹œ ì €ì¥
 */
async function saveDraft() {
    try {
        // í˜„ì¬ í¸ì§‘ëœ ë‚´ìš© ìˆ˜ì§‘
        const qaElements = document.querySelectorAll('.qa-pair');
        qaElements.forEach((qaEl, index) => {
            const questionEl = qaEl.querySelector('[data-type="question"]');
            const answerEl = qaEl.querySelector('[data-type="answer"]');
            
            if (qaList[index]) {
                qaList[index].question = questionEl.textContent;
                qaList[index].answer = answerEl.textContent;
            }
        });
        
        const statementData = {
            investigationDate: document.getElementById('investigationDate').value,
            investigationLocation: document.getElementById('investigationLocation').value,
            investigationOrg: document.getElementById('investigationOrg').value,
            investigator: document.getElementById('investigator').value,
            subjectName: document.getElementById('subjectName').value,
            subjectBirth: document.getElementById('subjectBirth').value,
            subjectOrg: document.getElementById('subjectOrg').value,
            subjectPosition: document.getElementById('subjectPosition').value,
            subjectContact: document.getElementById('subjectContact').value,
            qaList: qaList
        };
        
        const token = localStorage.getItem('token');
        
        const response = await fetch('/api/save-statement', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(statementData)
        });
        
        if (!response.ok) {
            throw new Error('ì €ì¥ ì‹¤íŒ¨');
        }
        
        showAlert('ì§„ìˆ ì„œê°€ ì„ì‹œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    } catch (error) {
        console.error('ì €ì¥ ì˜¤ë¥˜:', error);
        showAlert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
    }
}

/**
 * í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°
 */
async function exportToPdf() {
    try {
        // í˜„ì¬ í¸ì§‘ëœ ë‚´ìš© ìˆ˜ì§‘
        const qaElements = document.querySelectorAll('.qa-pair');
        qaElements.forEach((qaEl, index) => {
            const questionEl = qaEl.querySelector('[data-type="question"]');
            const answerEl = qaEl.querySelector('[data-type="answer"]');
            
            if (qaList[index]) {
                qaList[index].question = questionEl.textContent;
                qaList[index].answer = answerEl.textContent;
            }
        });
        
        // í…ìŠ¤íŠ¸ íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
        const textContent = generateTextFormat();
        downloadTextFile(textContent);
        
        showAlert('ì§„ìˆ ì„œê°€ í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
    } catch (error) {
        console.error('ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
        showAlert('ë‚´ë³´ë‚´ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
    }
}

/**
 * í…ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ì§„ìˆ ì„œ ìƒì„±
 */
function generateTextFormat() {
    const investigationDate = document.getElementById('investigationDate').value || 'ë¯¸ì…ë ¥';
    const investigationLocation = document.getElementById('investigationLocation').value || 'ë¯¸ì…ë ¥';
    const investigationOrg = document.getElementById('investigationOrg').value || 'ë¯¸ì…ë ¥';
    const investigator = document.getElementById('investigator').value || 'ë¯¸ì…ë ¥';
    
    const subjectName = document.getElementById('subjectName').value || 'ë¯¸ì…ë ¥';
    const subjectBirth = document.getElementById('subjectBirth').value || 'ë¯¸ì…ë ¥';
    const subjectOrg = document.getElementById('subjectOrg').value || 'ë¯¸ì…ë ¥';
    const subjectPosition = document.getElementById('subjectPosition').value || 'ë¯¸ì…ë ¥';
    const subjectContact = document.getElementById('subjectContact').value || 'ë¯¸ì…ë ¥';
    
    let text = '';
    
    text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
    text += '                ë…¸ì¸í•™ëŒ€ ì¡°ì‚¬ ì§„ìˆ ì„œ\n';
    text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    text += 'ã€ ì¡°ì‚¬ ì •ë³´ ã€‘\n';
    text += `ì¡°ì‚¬ì¼ì‹œ: ${investigationDate}\n`;
    text += `ì¡°ì‚¬ì¥ì†Œ: ${investigationLocation}\n`;
    text += `ì¡°ì‚¬ê¸°ê´€: ${investigationOrg}\n`;
    text += `ì¡° ì‚¬ ì: ${investigator}\n\n`;
    
    text += 'ã€ í”¼ì¡°ì‚¬ì ì •ë³´ ã€‘\n';
    text += `ì„±    ëª…: ${subjectName}\n`;
    text += `ìƒë…„ì›”ì¼: ${subjectBirth}\n`;
    text += `ì†Œì†ê¸°ê´€: ${subjectOrg}\n`;
    text += `ì§    ìœ„: ${subjectPosition}\n`;
    text += `ì—° ë½ ì²˜: ${subjectContact}\n\n`;
    
    text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
    text += '                  ì§„ìˆ  ë‚´ìš©\n';
    text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    qaList.forEach((qa, index) => {
        text += `ë¬¸${index + 1}. ${qa.question}\n`;
        text += `ë‹µ${index + 1}. ${qa.answer}\n\n`;
    });
    
    text += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    text += 'ìœ„ ë‚´ìš©ì€ ì‚¬ì‹¤ê³¼ ë‹¤ë¦„ì—†ìŒì„ í™•ì¸í•©ë‹ˆë‹¤.\n\n';
    text += `ì‘ì„±ì¼ì: ${new Date().toLocaleDateString('ko-KR')}\n\n`;
    text += 'ì§„ìˆ ì ì„±ëª…:                   (ì„œëª… ë˜ëŠ” ì¸)\n\n';
    text += 'ì¡°ì‚¬ì ì„±ëª…:                   (ì„œëª… ë˜ëŠ” ì¸)\n\n';
    
    return text;
}

/**
 * í…ìŠ¤íŠ¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
 */
function downloadTextFile(content) {
    const subjectName = document.getElementById('subjectName').value || 'ì§„ìˆ ì„œ';
    const date = new Date().toISOString().split('T')[0];
    const filename = `${subjectName}_ì§„ìˆ ì„œ_${date}.txt`;
    
    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = filename;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
    yPos += 20;
    doc.text('ìœ„ ì§„ìˆ ì´ ì‚¬ì‹¤ê³¼ ë‹¤ë¦„ì—†ìŒì„ í™•ì¸í•©ë‹ˆë‹¤.', 20, yPos);
    yPos += 15;
    doc.text('ì§„ìˆ ì: _________________ (ì„œëª…)', 20, yPos);
    yPos += 10;
    doc.text('ì¡°ì‚¬ì: _________________ (ì„œëª…)', 20, yPos);
    
    // íŒŒì¼ëª…
    const filename = `ì§„ìˆ ì„œ_${document.getElementById('subjectName').value || 'unknown'}_${new Date().toISOString().split('T')[0]}.pdf`;
    
    doc.save(filename);
}

========================================
íŒŒì¼: public/js/main.js
========================================
    // í¸ì§‘ ëª¨ë“œì¼ ë•ŒëŠ” ì·¨ì†Œ
    if (isEditMode) {
        // í¸ì§‘ ì·¨ì†Œ - ì›ë˜ ë°ì´í„°ë¡œ ë‹¤ì‹œ í‘œì‹œ
        if (confirm('ìˆ˜ì • ë‚´ìš©ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            exitEditMode();
            displayReport(currentReport); // ì›ë˜ ë°ì´í„°ë¡œ ë‹¤ì‹œ í‘œì‹œ
        }
        return;
    }
    
    if (!currentReport) {
        alert('ë‹¤ìš´ë¡œë“œí•  ìƒë‹´ì¼ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
    }

    try {
        // TXT í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        const txtContent = convertReportToTxt(currentReport);
        
        // Blob ìƒì„± (UTF-8 with BOM for Windows compatibility)
        const blob = new Blob(['\ufeff' + txtContent], { type: 'text/plain;charset=utf-8' });
        
        // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `ìƒë‹´ì¼ì§€_${currentReport.ê¸°ë³¸ì •ë³´.ì ‘ìˆ˜ë²ˆí˜¸}_${currentReport.ê¸°ë³¸ì •ë³´.ìƒë‹´ì¼ì}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
        
        console.log('âœ… TXT íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');
        
    } catch (error) {
        console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
        alert('TXT íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
    }
});

// ìƒë‹´ì¼ì§€ë¥¼ TXT í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
function convertReportToTxt(report) {
    const consultationTypeText = {
        'phone': 'ì „í™”ìƒë‹´',
        'visit': 'ë°©ë¬¸ìƒë‹´',
        'office': 'ë‚´ë°©ìƒë‹´'
    };
    
    let txt = '';
    
    // í—¤ë”
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
    txt += 'ë…¸ì¸ë³´í˜¸ì „ë¬¸ê¸°ê´€ ìƒë‹´ì¼ì§€\n';
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 1. ê¸°ë³¸ì •ë³´
    txt += 'â–  1. ê¸°ë³¸ì •ë³´\n\n';
    txt += `ìƒë‹´ì¼ì: ${report.ê¸°ë³¸ì •ë³´.ìƒë‹´ì¼ì}\n`;
    txt += `ìƒë‹´ìœ í˜•: ${consultationTypeText[report.ê¸°ë³¸ì •ë³´.ìƒë‹´ìœ í˜•] || report.ê¸°ë³¸ì •ë³´.ìƒë‹´ìœ í˜•}\n`;
    txt += `ì ‘ìˆ˜ë²ˆí˜¸: ${report.ê¸°ë³¸ì •ë³´.ì ‘ìˆ˜ë²ˆí˜¸}\n`;
    txt += `ìƒë‹´ì›: ${report.ê¸°ë³¸ì •ë³´.ìƒë‹´ì› || 'ë¯¸ì…ë ¥'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 2. ìƒë‹´ ìš”ì•½
    txt += 'â–  2. ìƒë‹´ ìš”ì•½\n\n';
    txt += `${report.ìƒë‹´ìš”ì•½ || 'ì •ë³´ ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 3. ìƒë‹´ ë‚´ìš© ì •ë¦¬
    txt += 'â–  3. ìƒë‹´ ë‚´ìš© ì •ë¦¬ (ì‹œê°„ìˆœ ì„œìˆ )\n\n';
    txt += `${report.ìƒë‹´ë‚´ìš©ì •ë¦¬ || 'ì •ë³´ ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 4. ì‹ ê³ ì/ë‚´ë‹´ì ì •ë³´
    txt += 'â–  4. ì‹ ê³ ì/ë‚´ë‹´ì ì •ë³´\n\n';
    txt += `ì‹ ê³ ìëª…: ${report.ì‹ ê³ ìì •ë³´?.ì‹ ê³ ìëª… || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ê´€ê³„: ${report.ì‹ ê³ ìì •ë³´?.ê´€ê³„ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì—°ë½ì²˜: ${report.ì‹ ê³ ìì •ë³´?.ì—°ë½ì²˜ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì‹ ê³  ê²½ìœ„: ${report.ì‹ ê³ ìì •ë³´?.ì‹ ê³ ê²½ìœ„ || 'ë¯¸ì…ë ¥'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 5. í”¼í•´ë…¸ì¸(í´ë¼ì´ì–¸íŠ¸) ì •ë³´
    txt += 'â–  5. í”¼í•´ë…¸ì¸(í´ë¼ì´ì–¸íŠ¸) ì •ë³´\n\n';
    txt += 'â–¶ ì¸ì ì‚¬í•­\n';
    txt += `ì„±ëª…: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ì„±ëª… || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì„±ë³„: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ì„±ë³„ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ìƒë…„ì›”ì¼: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ìƒë…„ì›”ì¼ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì—°ë ¹: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ì—°ë ¹ || 'ë¯¸ì…ë ¥'}ì„¸\n`;
    txt += `ì—°ë½ì²˜: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ì—°ë½ì²˜ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì£¼ì†Œ: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ì£¼ì†Œ || 'ë¯¸ì…ë ¥'}\n\n`;
    
    txt += 'â–¶ ê±´ê°•ìƒíƒœ\n';
    txt += `ì‹ ì²´ì  ê±´ê°•: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ê±´ê°•ìƒíƒœ?.ì‹ ì²´ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì •ì‹ ì  ê±´ê°•: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ê±´ê°•ìƒíƒœ?.ì •ì‹  || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ë³µìš© ì•½ë¬¼: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ê±´ê°•ìƒíƒœ?.ë³µìš©ì•½ë¬¼ || 'ì—†ìŒ'}\n\n`;
    
    txt += 'â–¶ ê²½ì œìƒíƒœ\n';
    txt += `${report.í”¼í•´ë…¸ì¸ì •ë³´?.ê²½ì œìƒíƒœ || 'ë¯¸ì…ë ¥'}\n\n`;
    
    txt += 'â–¶ ê°€ì¡±ê´€ê³„\n';
    txt += `${report.í”¼í•´ë…¸ì¸ì •ë³´?.ê°€ì¡±ê´€ê³„ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì£¼ ëŒë´„ ì œê³µì: ${report.í”¼í•´ë…¸ì¸ì •ë³´?.ì£¼ëŒë´„ì œê³µì || 'ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 6. í–‰ìœ„ì(í•™ëŒ€ì˜ì‹¬ì) ì •ë³´
    txt += 'â–  6. í–‰ìœ„ì(í•™ëŒ€ì˜ì‹¬ì) ì •ë³´\n\n';
    txt += `ì„±ëª…: ${report.í–‰ìœ„ìì •ë³´?.ì„±ëª… || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ê´€ê³„: ${report.í–‰ìœ„ìì •ë³´?.ê´€ê³„ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì„±ë³„: ${report.í–‰ìœ„ìì •ë³´?.ì„±ë³„ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì—°ë ¹: ${report.í–‰ìœ„ìì •ë³´?.ì—°ë ¹ || 'ë¯¸ì…ë ¥'}ì„¸\n`;
    txt += `ì—°ë½ì²˜: ${report.í–‰ìœ„ìì •ë³´?.ì—°ë½ì²˜ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `íŠ¹ì„±: ${report.í–‰ìœ„ìì •ë³´?.íŠ¹ì„± || 'ë¯¸ì…ë ¥'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 7. í•™ëŒ€ ì˜ì‹¬ ë‚´ìš©
    txt += 'â–  7. í•™ëŒ€ ì˜ì‹¬ ë‚´ìš©\n\n';
    txt += `í•™ëŒ€ ìœ í˜•: ${report.í•™ëŒ€ë‚´ìš©?.í•™ëŒ€ìœ í˜• || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ë°œìƒ ì‹œê¸°: ${report.í•™ëŒ€ë‚´ìš©?.ë°œìƒì‹œê¸° || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ë°œìƒ ì¥ì†Œ: ${report.í•™ëŒ€ë‚´ìš©?.ë°œìƒì¥ì†Œ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `êµ¬ì²´ì  í–‰ìœ„: ${report.í•™ëŒ€ë‚´ìš©?.êµ¬ì²´ì í–‰ìœ„ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì‹¬ê°ì„±: ${report.í•™ëŒ€ë‚´ìš©?.ì‹¬ê°ì„± || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì¦ê±°: ${report.í•™ëŒ€ë‚´ìš©?.ì¦ê±° || 'ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 8. í”¼í•´ë…¸ì¸ì˜ í˜„ì¬ ìƒíƒœ
    txt += 'â–  8. í”¼í•´ë…¸ì¸ì˜ í˜„ì¬ ìƒíƒœ\n\n';
    txt += `ì‹ ì²´ ìƒíƒœ: ${report.í˜„ì¬ìƒíƒœ?.ì‹ ì²´ìƒíƒœ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì •ì„œ ìƒíƒœ: ${report.í˜„ì¬ìƒíƒœ?.ì •ì„œìƒíƒœ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ìƒí™œ í™˜ê²½: ${report.í˜„ì¬ìƒíƒœ?.ìƒí™œí™˜ê²½ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ìœ„í—˜ë„: ${report.í˜„ì¬ìƒíƒœ?.ìœ„í—˜ë„ || 'ë¯¸ì…ë ¥'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 9. í˜„ì¥ì¡°ì‚¬ ë‚´ìš©
    txt += 'â–  9. í˜„ì¥ì¡°ì‚¬ ë‚´ìš©\n\n';
    txt += `ì‹¤ì‹œ ì—¬ë¶€: ${report.í˜„ì¥ì¡°ì‚¬?.ì‹¤ì‹œì—¬ë¶€ ? 'ì‹¤ì‹œí•¨' : 'ì‹¤ì‹œ ì•ˆ í•¨'}\n`;
    txt += `ë°©ë¬¸ ì¼ì‹œ: ${report.í˜„ì¥ì¡°ì‚¬?.ë°©ë¬¸ì¼ì‹œ || 'í•´ë‹¹ì—†ìŒ'}\n`;
    txt += `ê´€ì°° ë‚´ìš©: ${report.í˜„ì¥ì¡°ì‚¬?.ê´€ì°°ë‚´ìš© || 'í•´ë‹¹ì—†ìŒ'}\n`;
    txt += `ë©´ë‹´ ë‚´ìš©: ${report.í˜„ì¥ì¡°ì‚¬?.ë©´ë‹´ë‚´ìš© || 'í•´ë‹¹ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 10. ì¦‰ì‹œ ì¡°ì¹˜ì‚¬í•­
    txt += 'â–  10. ì¦‰ì‹œ ì¡°ì¹˜ì‚¬í•­\n\n';
    txt += `ì‘ê¸‰ ì¡°ì¹˜: ${report.ì¦‰ì‹œì¡°ì¹˜?.ì‘ê¸‰ì¡°ì¹˜ || 'ì—†ìŒ'}\n`;
    txt += `ë¶„ë¦¬ ë³´í˜¸: ${report.ì¦‰ì‹œì¡°ì¹˜?.ë¶„ë¦¬ë³´í˜¸ || 'ì—†ìŒ'}\n`;
    txt += `ì˜ë£Œ ì—°ê³„: ${report.ì¦‰ì‹œì¡°ì¹˜?.ì˜ë£Œì—°ê³„ || 'ì—†ìŒ'}\n`;
    txt += `ê¸°íƒ€ ì¡°ì¹˜: ${report.ì¦‰ì‹œì¡°ì¹˜?.ê¸°íƒ€ì¡°ì¹˜ || 'ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 11. í–¥í›„ ê³„íš
    txt += 'â–  11. í–¥í›„ ê³„íš\n\n';
    txt += `ë‹¨ê¸° ê³„íš: ${report.í–¥í›„ê³„íš?.ë‹¨ê¸°ê³„íš || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì¥ê¸° ê³„íš: ${report.í–¥í›„ê³„íš?.ì¥ê¸°ê³„íš || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ëª¨ë‹ˆí„°ë§: ${report.í–¥í›„ê³„íš?.ëª¨ë‹ˆí„°ë§ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `ì—°ê³„ ê¸°ê´€: ${report.í–¥í›„ê³„íš?.ì—°ê³„ê¸°ê´€ || 'ì—†ìŒ'}\n\n`;
    
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n';
    
    // 12. ìƒë‹´ì› ì˜ê²¬ ë° íŠ¹ì´ì‚¬í•­
    txt += 'â–  12. ìƒë‹´ì› ì˜ê²¬ ë° íŠ¹ì´ì‚¬í•­\n\n';
    txt += `ìƒë‹´ì› ì¢…í•© ì˜ê²¬: ${report.ìƒë‹´ì›ì˜ê²¬ || 'ë¯¸ì…ë ¥'}\n`;
    txt += `íŠ¹ì´ì‚¬í•­: ${report.íŠ¹ì´ì‚¬í•­ || 'ì—†ìŒ'}\n\n`;
    
    // í‘¸í„°
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
    txt += `ìƒì„±ì¼ì‹œ: ${new Date().toLocaleString('ko-KR')}\n`;
    txt += 'ì‹œìŠ¤í…œ: CaseNetAI by WellPartners\n';
    txt += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n';
    
    return txt;
}

// ìŠ¤ë¬´ìŠ¤ ìŠ¤í¬ë¡¤
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìƒíƒœ ì²´í¬
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ¯ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
    checkFormValid();
});

========================================
íŒŒì¼: routes/statement.js
========================================

    if (result.rows.length === 0) {
      return res.status(404).json({
        success: false,
        error: 'ì§„ìˆ ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
      });
    }

    res.json({
      success: true,
      statement: result.rows[0]
    });

  } catch (error) {
    console.error('âŒ ì§„ìˆ ì„œ ì¡°íšŒ ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: 'ì§„ìˆ ì„œ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
      details: error.message
    });
  }
});

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// GET /api/statement/list
// ì§„ìˆ ì„œ ëª©ë¡ ì¡°íšŒ
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
router.get('/list', authenticateToken, async (req, res) => {
  const db = await getDB();
  
  try {
    const userId = req.user.userId;
    const { status, page = 1, limit = 20, search } = req.query;

    let query = `
      SELECT s.*, u.username as creator_name
      FROM statements s
      LEFT JOIN users u ON s.user_id = u.id
      WHERE s.user_id = $1
    `;
    const params = [userId];
    let paramIndex = 2;

    // ìƒíƒœ í•„í„°
    if (status) {
      query += ` AND s.status = $${paramIndex}`;
      params.push(status);
      paramIndex++;
    }

    // ê²€ìƒ‰
    if (search) {
      query += ` AND (
        s.subject_name ILIKE $${paramIndex} OR
        s.subject_organization ILIKE $${paramIndex} OR
        s.investigation_agency ILIKE $${paramIndex}
      )`;
      params.push(`%${search}%`);
      paramIndex++;
    }

    // ì •ë ¬ ë° í˜ì´ì§•
    query += ` ORDER BY s.investigation_date DESC, s.created_at DESC`;
    query += ` LIMIT $${paramIndex} OFFSET $${paramIndex + 1}`;
    params.push(limit, (page - 1) * limit);

    const result = await db.query(query, params);

    // ì „ì²´ ê°œìˆ˜ ì¡°íšŒ
    let countQuery = `SELECT COUNT(*) FROM statements WHERE user_id = $1`;
    const countParams = [userId];
    
    if (status) {
      countQuery += ` AND status = $2`;
      countParams.push(status);
    }

    const countResult = await db.query(countQuery, countParams);
    const totalCount = parseInt(countResult.rows[0].count);

    res.json({
      success: true,
      statements: result.rows,
      pagination: {
        page: parseInt(page),
        limit: parseInt(limit),
        totalCount,
        totalPages: Math.ceil(totalCount / limit)
      }
    });

  } catch (error) {
    console.error('âŒ ì§„ìˆ ì„œ ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: 'ì§„ìˆ ì„œ ëª©ë¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
      details: error.message
    });
  }
});

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// DELETE /api/statement/:id
// ì§„ìˆ ì„œ ì‚­ì œ
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
router.delete('/:id', authenticateToken, async (req, res) => {
  const db = await getDB();
  
  try {
    const statementId = req.params.id;
    const userId = req.user.userId;

    // ê¶Œí•œ í™•ì¸
    const checkResult = await db.query(
      'SELECT * FROM statements WHERE id = $1 AND user_id = $2',
      [statementId, userId]
    );

    if (checkResult.rows.length === 0) {
      return res.status(403).json({
        success: false,
        error: 'ì‚­ì œ ê¶Œí•œì´ ì—†ê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì§„ìˆ ì„œì…ë‹ˆë‹¤.'
      });
    }

    console.log('ğŸ—‘ï¸ ì§„ìˆ ì„œ ì‚­ì œ: ID', statementId);

    await db.query(
      'DELETE FROM statements WHERE id = $1 AND user_id = $2',
      [statementId, userId]
    );

    console.log('âœ… ì§„ìˆ ì„œ ì‚­ì œ ì™„ë£Œ');

    res.json({
      success: true,
      message: 'ì§„ìˆ ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.'
    });

  } catch (error) {
    console.error('âŒ ì§„ìˆ ì„œ ì‚­ì œ ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: 'ì§„ìˆ ì„œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
      details: error.message
    });
  }
});

module.exports = router;
