# 컴퓨터프로그램 설명서

**프로그램명**: 노인보호전문기관 업무자동화 시스템 CaseNetAI  
**버전**: 1.0.0  
**작성일**: 2026년 01월 21일

---

## 1. 프로그램 개요

### 1.1 개발 목적
노인보호전문기관 상담원의 업무 자동화를 통한 효율성 향상 및 상담 품질 개선

### 1.2 주요 목표
- 상담일지 작성 시간 70% 단축
- 표준화된 문서 양식 제공
- 개인정보 보호 강화
- 업무 프로세스 디지털화

---

## 2. 시스템 구성

### 2.1 시스템 아키텍처

```
[클라이언트]
    ↓
[웹 브라우저]
    ↓
[프론트엔드 (HTML/CSS/JavaScript)]
    ↓
[백엔드 API (Node.js + Express)]
    ↓
[외부 API 연동]
    - OpenAI Whisper (STT)
    - OpenAI GPT-4o (AI 분석)
    - Google Gemini AI
    - Naver Clova STT
    - 공공데이터 포털
    ↓
[데이터베이스 (PostgreSQL)]
```

### 2.2 주요 모듈

#### (1) 인증 모듈 (Authentication Module)
- 파일: `routes/auth.js`, `services/authService.js`
- 기능: 사용자 로그인, 회원가입, JWT 토큰 관리
- 특징: 소셜 로그인 지원 (네이버, 구글, 카카오)

#### (2) 상담일지 자동생성 모듈
- 파일: `public/elderly-protection.html`, `public/js/main.js`
- 기능: 음성 파일 업로드 → STT → AI 분석 → 상담일지 생성
- API: `/api/upload-audio`, `/api/analyze-audio`

#### (3) 진술서 작성 모듈
- 파일: `routes/statement.js`, `public/statement-recording.html`
- 기능: 실시간 녹음, 문답 분리, PDF 출력
- API: `/api/statement/transcribe`, `/api/statement/parse`

#### (4) 문서 익명화 모듈
- 파일: `public/anonymization.html`, `public/js/anonymization.js`
- 기능: 개인정보 자동 감지 및 마스킹
- 지원: 이름, 주민번호, 전화번호, 주소 등



#### (5) 관리자 모듈
- 파일: `routes/admin.js`, `routes/system-admin.js`
- 기능: 사용자 관리, 크레딧 관리, 통계
- 권한: system_admin, org_admin

---

## 3. 주요 기능 상세

### 3.1 음성 파일 처리

#### 입력
- 지원 포맷: MP3, WAV, M4A, OGG, WebM, MP4
- 최대 크기: 100MB
- 업로드 방식: 파일 선택 또는 드래그 앤 드롭

#### 처리 과정
1. 파일 검증 (형식, 크기)
2. 서버 업로드 (`multer` 라이브러리)
3. STT 엔진 선택 (Whisper 또는 Clova)
4. 음성 → 텍스트 변환
5. 비용 계산 및 표시

#### 출력
- 전체 텍스트 (transcript)
- 단어별 타임스탬프 (word-level timestamps)
- 변환 소요 시간
- 예상 비용

### 3.2 AI 기반 상담일지 생성

#### 입력
- 음성 변환 텍스트
- 상담 유형 (전화, 방문, 내방)
- 상담 단계 (신고접수, 현장조사 등)

#### AI 프롬프트 예시
```
당신은 노인보호전문기관의 전문 상담원입니다.
다음 상담 내용을 분석하여 표준 양식에 맞게 정리하세요.

[상담 텍스트]
...

[출력 양식]
1. 기본정보
2. 피해노인 정보
3. 행위자 정보
4. 상담내용
5. 조치사항
6. 특이사항
```

#### 출력
- 표준화된 상담일지 (텍스트)
- 항목별 구조화된 데이터
- 편집 가능한 형태
- 다운로드 기능 (.txt, .docx)

### 3.3 진술서 자동 작성

#### 기능
1. **실시간 녹음**
   - 브라우저 마이크 권한 요청
   - WebRTC 기반 오디오 녹음
   - 파형 시각화

2. **문답 분리**
   - AI가 질문과 답변 자동 구분
   - 화자 식별
   - 조서체 변환 ("~했다", "~이라고 말했다")

3. **편집 기능**
   - 실시간 텍스트 수정
   - 문단 추가/삭제
   - 서명란 추가

4. **PDF 출력**
   - 공식 문서 양식
   - 서명 이미지 삽입
   - A4 용지 최적화

### 3.4 문서 익명화

#### 자동 감지 항목
- 이름 (한글 2-4자)
- 주민번호 (123456-1234567 형식)
- 전화번호 (010-1234-5678 형식)
- 이메일 (example@domain.com)
- 주소 (도로명, 지번)
- 계좌번호

#### 마스킹 방식
- 이름: 홍*동
- 주민번호: 123456-1******
- 전화번호: 010-****-5678
- 이메일: exa***@domain.com

### 3.5 보안 기능

#### 인증 (Authentication)
- JWT 기반 토큰 인증
- 토큰 유효기간: 7일
- Refresh Token 지원

#### 인가 (Authorization)
- 역할 기반 접근 제어 (RBAC)
- 권한: system_admin, org_admin, user
- 페이지별 권한 검증

#### 데이터 보호
- bcrypt 비밀번호 해싱 (SALT_ROUNDS: 12)
- HTTPS 강제 (Helmet.js)
- XSS 방지 (Content Security Policy)
- SQL Injection 방지 (Parameterized Query)

#### Rate Limiting
- 일반 API: 15분당 100회
- 로그인 API: 15분당 5회
- 익명화 API: 1분당 10회

---

## 4. 데이터베이스 설계

### 4.1 주요 테이블

#### users (사용자)
```sql
- id (PK)
- oauth_email (이메일)
- name (이름)
- phone (전화번호)
- role (권한: system_admin, org_admin, user)
- organization_id (소속 기관)
- is_approved (승인 여부)
- created_at (생성일시)
```

#### credits (크레딧)
```sql
- id (PK)
- user_id (FK → users.id)
- balance (잔액)
- free_trial_count (무료 체험 횟수)
- total_purchased (총 구매 금액)
- total_used (총 사용 금액)
```

#### statements (진술서)
```sql
- id (PK)
- user_id (FK → users.id)
- title (제목)
- content (내용)
- audio_url (녹음 파일 URL)
- created_at (작성일시)
- updated_at (수정일시)
```

#### sessions (세션)
```sql
- id (PK)
- user_id (FK → users.id)
- token (JWT 토큰)
- refresh_token (갱신 토큰)
- ip_address (IP 주소)
- user_agent (브라우저 정보)
- expires_at (만료일시)
```

---

## 5. API 명세

### 5.1 인증 API

#### POST /api/auth/register
- 설명: 회원가입 (관리자 전용)
- 입력: email, password, name, masterPassword
- 출력: { success, userId, message }

#### POST /api/auth/login
- 설명: 이메일 로그인
- 입력: email, password
- 출력: { success, token, refreshToken, user }

#### GET /api/auth/naver
- 설명: 네이버 로그인 시작

#### GET /api/auth/naver/callback
- 설명: 네이버 로그인 콜백

### 5.2 상담일지 API

#### POST /api/upload-audio
- 설명: 음성 파일 업로드 및 상담일지 생성
- 입력: audioFile (multipart), consultationType, consultationStage, sttEngine
- 출력: { success, report, processingTime, actualCost, creditInfo }

#### POST /api/analyze-audio
- 설명: 음성 파일 분석 및 비용 예측
- 입력: audioFile (multipart)
- 출력: { success, fileInfo, duration, costEstimate }

### 5.3 진술서 API

#### POST /api/statement/transcribe
- 설명: 음성 → 텍스트 변환
- 입력: audioFile (multipart)
- 출력: { success, transcript, duration, words, audioUrl }

#### POST /api/statement/parse
- 설명: 문답 분리
- 입력: { transcript }
- 출력: { success, parsed, qaList }

#### POST /api/statement/save
- 설명: 진술서 저장
- 입력: { title, content, audioUrl }
- 출력: { success, statementId }

#### GET /api/statement/:id
- 설명: 진술서 조회
- 출력: { success, statement }

#### GET /api/statement/list
- 설명: 진술서 목록
- 출력: { success, statements }

### 5.4 익명화 API

#### POST /api/anonymize
- 설명: 문서 익명화
- 입력: { text, maskingLevel }
- 출력: { success, anonymizedText, detectedInfo }



---

## 6. 기술 스택

### 6.1 백엔드
- **런타임**: Node.js 18.x
- **프레임워크**: Express 4.18
- **데이터베이스**: PostgreSQL 8.16
- **인증**: JWT, Passport.js
- **파일 업로드**: Multer
- **보안**: Helmet.js, bcrypt, express-rate-limit

### 6.2 프론트엔드
- **언어**: HTML5, CSS3, JavaScript (ES6+)
- **스타일**: Vanilla CSS (반응형)
- **HTTP 클라이언트**: Fetch API

### 6.3 외부 API
- **OpenAI API**: Whisper (STT), GPT-4o (AI)
- **Google Gemini AI**: AI 분석
- **Naver Clova**: STT (대안)

### 6.4 배포
- **플랫폼**: Vercel (Serverless)
- **도메인**: https://casenetai.kr
- **SSL**: 자동 (Vercel 제공)

---

## 7. 시스템 요구사항

### 7.1 서버
- **CPU**: 2 Core 이상
- **RAM**: 4GB 이상
- **저장공간**: 10GB 이상
- **OS**: Linux (Ubuntu 20.04 권장)
- **Node.js**: v18.x 이상

### 7.2 클라이언트
- **브라우저**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **화면**: 1024x768 이상
- **인터넷**: 10Mbps 이상

---

## 8. 설치 및 실행

### 8.1 설치
```bash
# 저장소 클론
git clone https://github.com/YUNHYEONJUN/casenetai.git
cd casenetai

# 의존성 설치
npm install

# 환경 변수 설정
cp .env.example .env
# .env 파일에 API 키 입력
```

### 8.2 실행
```bash
# 개발 모드
npm start

# 프로덕션 모드
NODE_ENV=production npm start
```

### 8.3 접속
```
http://localhost:3000
```

---

## 9. 사용 시나리오

### 시나리오 1: 상담일지 작성

1. 로그인 (네이버/구글)
2. "노인보호 상담일지" 메뉴 클릭
3. 상담 유형 선택 (전화/방문/내방)
4. 상담 단계 선택 (신고접수/현장조사 등)
5. 녹음 파일 업로드 (드래그 앤 드롭)
6. 비용 확인 후 "변환 시작" 클릭
7. AI가 자동으로 상담일지 생성
8. 내용 확인 및 수정
9. 다운로드 (.txt 또는 .docx)

**소요 시간**: 10분 상담 기준 2-3분  
**기존 방식**: 30-60분 소요 → **70% 시간 단축**

### 시나리오 2: 진술서 작성

1. "진술서 자동 작성" 메뉴 클릭
2. 녹음 시작 버튼 클릭
3. 질문과 답변 진행
4. 녹음 종료
5. AI가 자동으로 문답 분리
6. 조서체로 자동 변환
7. 서명란 추가
8. PDF 다운로드

**소요 시간**: 1시간 진술 기준 5분  
**기존 방식**: 2-3시간 소요 → **90% 시간 단축**

### 시나리오 3: 문서 익명화

1. "문서 익명화" 메뉴 클릭
2. 원본 문서 붙여넣기 또는 파일 업로드
3. 마스킹 수준 선택 (낮음/중간/높음)
4. "익명화 시작" 클릭
5. AI가 자동으로 개인정보 감지 및 마스킹
6. 결과 확인 및 다운로드

**소요 시간**: 10페이지 기준 1분  
**기존 방식**: 30-60분 수작업 → **95% 시간 단축**

---

## 10. 기대 효과

### 10.1 정량적 효과
- 상담일지 작성 시간: 30분 → 5분 (83% 감소)
- 진술서 작성 시간: 2시간 → 10분 (92% 감소)
- 문서 익명화 시간: 1시간 → 2분 (97% 감소)
- 연간 업무시간 절감: 직원 1인당 약 500시간

### 10.2 정성적 효과
- 표준화된 문서 양식 → 품질 향상
- 업무 부담 감소 → 직원 만족도 증가
- 개인정보 보호 강화 → 법적 리스크 감소
- 상담에 집중할 시간 확보 → 서비스 질 향상

### 10.3 경제적 효과
- 직원 1인당 연간 인건비 절감: 약 1,500만원
- 10인 기관 기준 연간 총 절감: 약 1억 5천만원
- 투자 대비 효과 (ROI): 약 3,000%

---

## 11. 향후 개선 계획

### 11.1 단기 (3개월)
- [ ] 음성 품질 개선 알고리즘 추가
- [ ] 다국어 지원 (영어, 중국어)
- [ ] 모바일 앱 개발

### 11.2 중기 (6개월)
- [ ] 화상 상담 녹화 지원
- [ ] 자동 번역 기능
- [ ] 통계 및 대시보드 강화

### 11.3 장기 (1년)
- [ ] 전국 노인보호기관 확대
- [ ] 다른 사회복지 분야 적용
- [ ] 오프라인 설치형 버전

---

## 12. 라이선스 및 저작권

### 저작권자
**윤현준**

### 저작권 등록
- 등록번호: (등록 후 기재)
- 등록일: 2026년 01월 ___일

### 사용 허가
본 프로그램은 저작권자의 허가 없이 무단으로 복제, 배포, 수정할 수 없습니다.

---

## 13. 문의처

### 개발자
- 성명: 윤현준
- 소속: 경기도사회서비스원 노인보호전문기관
- 이메일: yoonhj79@gmail.com
- 전화: 010-7216-5458

---

**작성일: 2026년 01월 21일**  
**최종 수정일: 2026년 01월 21일**  
**버전: 1.0.0**
